#ifndef OPCODE_TYPES_H
#define OPCODE_TYPES_H

#include <stdint.h>

enum class OperandMode {
    None,
    C1, // Constant 1
    DX, // Always DX
    // 8-bit registers
    AL,
    CL,
    DL,
    BL,
    AH,
    CH,
    DH,
    BH,
    // 16/32-bit registers
    eAX,
    eCX,
    eDX,
    eBX,
    eSP,
    eBP,
    eSI,
    eDI,
    // Segment registers
    ES,
    CS,
    SS,
    DS,
    FS,
    GS,
    // Remaining modes
    Ap,
    Cd,
    Dd,
    E,
    Eb,
    Ev,
    Ew,
    G,
    Gb,
    Gv,
    Gw,
    Ib,
    Ibs,
    Ibss,
    Iv,
    Ivds,
    Ivs,
    Iw,
    Jbs,
    Jvds,
    M,
    Ma,
    Mp,
    Mptp,
    Ms,
    Mw,
    MwRv,
    Ob,
    Ov,
    Rd,
    Sw,
    Td,
};

enum class InstructionMnem {
    UNDEF,
    TABLE,
    PREFIX,
    AAA,
    AAD,
    AAM,
    AAS,
    ADC,
    ADD,
    AND,
    ARPL,
    BOUND,
    BSF,
    BSR,
    BT,
    BTC,
    BTR,
    BTS,
    CALL,
    CALLF,
    CBW,
    CDQ,
    CLC,
    CLD,
    CLI,
    CLTS,
    CMC,
    CMP,
    CMPS,
    CMPSB,
    CWD,
    CWDE,
    DAA,
    DAS,
    DEC,
    DIV,
    ENTER,
    ESC,
    FWAIT,
    HLT,
    IDIV,
    IMUL,
    IN,
    INC,
    INS,
    INSB,
    INT,
    INT1,
    INT3,
    INTO,
    IRET,
    JB,
    JBE,
    JCXZ,
    JL,
    JLE,
    JMP,
    JMPF,
    JNB,
    JNBE,
    JNL,
    JNLE,
    JNO,
    JNP,
    JNS,
    JNZ,
    JO,
    JP,
    JS,
    JZ,
    LAHF,
    LAR,
    LDS,
    LEA,
    LEAVE,
    LES,
    LFS,
    LGDT,
    LGS,
    LIDT,
    LLDT,
    LMSW,
    LOADALL,
    LOCK,
    LODS,
    LODSB,
    LOOP,
    LOOPNZ,
    LOOPZ,
    LSL,
    LSS,
    LTR,
    LZCNT,
    MOV,
    MOVS,
    MOVSB,
    MOVSX,
    MOVZX,
    MUL,
    NEG,
    NOP,
    NOT,
    OR,
    OUT,
    OUTS,
    OUTSB,
    POP,
    POPA,
    POPF,
    PUSH,
    PUSHA,
    PUSHF,
    RCL,
    RCR,
    RETF,
    RETN,
    ROL,
    ROR,
    RSM,
    SAHF,
    SAL,
    SALC,
    SAR,
    SBB,
    SCAS,
    SCASB,
    SETB,
    SETBE,
    SETL,
    SETLE,
    SETMO,
    SETNB,
    SETNBE,
    SETNL,
    SETNLE,
    SETNO,
    SETNP,
    SETNS,
    SETNZ,
    SETO,
    SETP,
    SETS,
    SETZ,
    SGDT,
    SHL,
    SHLD,
    SHR,
    SHRD,
    SIDT,
    SLDT,
    SMSW,
    STC,
    STD,
    STI,
    STOS,
    STOSB,
    STR,
    SUB,
    TEST,
    TZCNT,
    UD1,
    UD2,
    VERR,
    VERW,
    XCHG,
    XLAT,
    XOR,
};


static constexpr int MaxInstructionOperands = 3;

struct Instruction {
    InstructionMnem mnemonic;
    union {
        OperandMode operands[MaxInstructionOperands];
        const Instruction* table;
    };
};

extern const char* const ModeStrings[];
extern const char* const MnemonicStrings[];

#endif
